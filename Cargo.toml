[workspace.package]
description = "Run Typst in JavaScriptWorld."
authors = ["Typst.ts Developers", "The Typst Project Developers"]
version = "0.2.1"
edition = "2021"
readme = "README.md"
license = "Apache-2.0"
homepage = "https://myriad-dreamin.github.io/typst.ts/"
repository = "https://github.com/Myriad-Dreamin/typst.ts"

[workspace]
members = [
    "cli",
    "core",
    "compiler",

    "exporter/ast",
    "exporter/canvas",
    "exporter/pdf",
    "exporter/raster",
    "exporter/serde",
    "exporter/tir",
    "exporter/ws",

    "packages/compiler",
    "packages/renderer",

    "server/dev",
    "server/remote",

    "tools/fontctl",

    "tests/common",
    "tests/integration",
]

[profile.release]
opt-level = 3
debug = true
lto = "thin"

[workspace.dependencies]

# typesetting
typst = "0.4.0"
typst-library = "0.4.0"
tiny-skia = "0.9.0"
ttf-parser = "0.18.1"
image = "0.24.6"

# general
anyhow = "1"
chrono = { version = "0.4", default-features = false, features = [
    "clock",
    "std",
] }
once_cell = "1.17.1"
parking_lot = "0.12.1"
futures = "0.3.28"
pollster = "0.3.0"
tokio = { version = "1.28.1", features = ["full"] }

# data structures
comemo = "0.3"
indexmap = "1.9.3"
elsa = "1.8.1"
ecow = "0.1.1"

# cli
clap = { version = "4.3", features = ["derive", "env", "unicode", "wrap_help"] }
clap_complete = "4.3"
clap_complete_fig = "4.3"

# net
tokio-tungstenite = "0.18.0"

# web
js-sys = "^0.3"
wasm-bindgen = "^0.2"
wasm-bindgen-futures = "^0.4"
wasm-bindgen-test = "0.3.0"
web-sys = "^0.3"

# cryptography and processing
base64 = "0.21.0"
byteorder = "1.4.3"
hex = "0.4.3"
flate2 = "1"
rmp-serde = "1.1.1"
serde = "1.0.163"
serde_json = "1.0.96"
serde-wasm-bindgen = "^0.5"
sha2 = "0.10.6"
siphasher = "0.3.10"

# logging and tracing
env_logger = "0.10.0"
log = "0.4.17"
tracing = "0.1.37"
tracing-error = "0.2"
tracing-subscriber = { version = "0.3.17", features = ["std"] }

# test
insta = "1.29.0"

# misc
codespan-reporting = "0.11"
dirs = "5"
human-panic = "1.1.4"
notify = "5"
vergen = { version = "7.5.1", features = ["build", "cargo", "git", "rustc"] }

# project core
typst-ts-core = "0.2"
typst-ts-compiler = "0.2"
typst-ts-test-common = "0.2"

# project exporters
typst-ts-ast-exporter = "0.2"
typst-ts-pdf-exporter = "0.2"
typst-ts-canvas-exporter = "0.2"
typst-ts-raster-exporter = "0.2"
typst-ts-serde-exporter = "0.2"
typst-ts-tir-exporter = "0.2"
typst-ts-ws-exporter = "0.2"

# project common components
typst-ts-dev-server = "0.2"

[patch.crates-io]
typst-ts-core = { path = "core" }
typst-ts-compiler = { path = "compiler" }
typst-ts-test-common = { path = "tests/common" }
typst-ts-ast-exporter = { path = "exporter/ast" }
typst-ts-canvas-exporter = { path = "exporter/canvas" }
typst-ts-pdf-exporter = { path = "exporter/pdf" }
typst-ts-raster-exporter = { path = "exporter/raster" }
typst-ts-serde-exporter = { path = "exporter/serde" }
typst-ts-tir-exporter = { path = "exporter/tir" }
typst-ts-ws-exporter = { path = "exporter/ws" }
typst-ts-dev-server = { path = "server/dev" }

typst = { git = "https://github.com/Myriad-Dreamin/typst.git", branch = "typst.ts" }
typst-library = { git = "https://github.com/Myriad-Dreamin/typst.git", branch = "typst.ts" }

# typst = { path = "../typst" }
# typst-library = { path = "../typst/library" }
