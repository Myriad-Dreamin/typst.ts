[workspace]
members = [
    "cli",
    "core",
    "compiler",

    "packages/compiler",
    "packages/renderer",

    "exporter/ast",
    "exporter/canvas",
    "exporter/pdf",
    "exporter/raster",
    "exporter/serde",
    "exporter/tir",
    "exporter/ws",

    "tools/fontctl",
    "contrib/dev-server",
]

[profile.release]
opt-level = 3
debug = true
lto = "thin"

[workspace.dependencies]

typst = "0.4.0"
typst-library = "0.4.0"
comemo = "0.3"
tiny-skia = "0.9.0"
ttf-parser = "0.18.1"
codespan-reporting = "0.11"

clap = { version = "4.3", features = ["derive", "env", "unicode", "wrap_help"] }
clap_complete = "4.3"
clap_complete_fig = "4.3"

once_cell = "1.17.1"
anyhow = "1"

indexmap = "1.9.3"
siphasher = "0.3.10"
elsa = "1.8.1"
hex = "0.4.3"
sha2 = "0.10.6"
flate2 = "1"
base64 = "0.21.0"
byteorder = "1.4.3"

pollster = "0.3.0"
tokio = {version = "1.28.1", features = ["full"]}

dirs = "5"
notify = "5"
parking_lot = "0.12.1"
chrono = { version = "0.4", default-features = false, features = [
  "clock",
  "std",
] }

serde = "1.0.163"
serde_json = "1.0.96"
serde-wasm-bindgen = "^0.5"
rmp-serde = "1.1.1"

log = "0.4.17"
env_logger = "0.10.0"

tracing = "0.1.37"
tracing-error = "0.2"
tracing-subscriber = { version = "0.3.17", features = ["std"] }

wasm-bindgen = "^0.2"
wasm-bindgen-futures = "^0.4"
js-sys = "^0.3"
web-sys = "^0.3"

typst-ts-core = "0.2"
typst-ts-compiler = "0.2"

typst-ts-ast-exporter = "0.2"
typst-ts-pdf-exporter = "0.2"
typst-ts-canvas-exporter = "0.2"
typst-ts-raster-exporter = "0.2"
typst-ts-serde-exporter = "0.2"
typst-ts-tir-exporter = "0.2"
typst-ts-ws-exporter = "0.2"

[patch.crates-io]
typst-ts-core = { path = "core" }
typst-ts-compiler = { path = "compiler" }
typst-ts-ast-exporter = { path = "exporter/ast" }
typst-ts-canvas-exporter = { path = "exporter/canvas" }
typst-ts-pdf-exporter = { path = "exporter/pdf" }
typst-ts-raster-exporter = { path = "exporter/raster" }
typst-ts-serde-exporter = { path = "exporter/serde" }
typst-ts-tir-exporter = { path = "exporter/tir" }
typst-ts-ws-exporter = { path = "exporter/ws" }

typst = { git = "https://github.com/Myriad-Dreamin/typst.git", branch = "typst.ts" }
typst-library = { git = "https://github.com/Myriad-Dreamin/typst.git", branch = "typst.ts" }

# typst = { path = "../typst" }
# typst-library = { path = "../typst/library" }
