const ignoredEvent=function(){var o={},i,n;return function(l,p,r){n=new Date().getTime(),r=r||"ignored event",i=o[r]?n-o[r]:n,i&gt;p&&(o[r]=n,l())}}(),overLappingSimp=function(o,i){var n=o.getBoundingClientRect(),l=i.getBoundingClientRect();return!(n.right&lt;l.left||n.left&gt;l.right||n.bottom&lt;l.top||n.top&gt;l.bottom)},overLapping=function(o,i){var n=o.getBoundingClientRect(),l=i.getBoundingClientRect();return overLappingSimp(o,i)&&(Math.abs(n.left-l.left)+Math.abs(n.right-l.right))/Math.max(n.width,l.width)&lt;.5&&(Math.abs(n.bottom-l.bottom)+Math.abs(n.top-l.top))/Math.max(n.height,l.height)&lt;.5};var searchIntersections=function(o){let i,n=o;for(;n;){if(n.classList.contains("typst-group")){i=n;break}n=n.parentElement}if(!n){console.log("no group found");return}const p=i.children,r=p.length,h=[];for(let g=0;g&lt;r;g++){const m=p[g];overLapping(m,o)&&h.push(m)}return h},getRelatedElements=function(o){let i=o.target.relatedElements;return i==null&&(i=o.target.relatedElements=searchIntersections(o.target)),i},linkmove=function(o){ignoredEvent(function(){const i=getRelatedElements(o);if(i!=null)for(var n=0;n&lt;i.length;n++){var l=i[n];l.classList.contains("hover")||l.classList.add("hover")}},200,"mouse-move")},linkleave=function(o){const i=getRelatedElements(o);if(i!=null)for(var n=0;n&lt;i.length;n++){var l=i[n];l.classList.contains("hover")&&l.classList.remove("hover")}};function findAncestor(o,i){for(;o&&!o.classList.contains(i);)o=o.parentElement;return o}window.typstProcessSvg=function(o){for(var i=o.getElementsByClassName("pseudo-link"),n=0;n&lt;i.length;n++){var l=i[n];l.addEventListener("mousemove",linkmove),l.addEventListener("mouseleave",linkleave)}function p(e){if(e.hasChildNodes())return e.firstChild;for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}function r(e,s){var t=e.startContainer,a=e.endContainer;if(t==a){if(s(t))return[t];if(s(t.parentElement))return[t.parentElement]}for(var d=[];t&&t!=a;)t=p(t),s(t)&&d.push(t);for(t=e.startContainer;t&&t!=e.commonAncestorContainer;)s(t)&&d.unshift(t),t=t.parentNode;return d}function h(e){if(window.getSelection){var s=window.getSelection();if(!s.isCollapsed)return r(s.getRangeAt(0),e)}return[]}o.addEventListener("copy",e=&gt;{const s=h(c=&gt;c.classList?.contains("tsel")||c.classList?.contains("typst-content-hint")),t=[];let a=!1;for(let c of s)if(c.classList.contains("tsel")){t.push(c.textContent);const u=c.getBoundingClientRect();a=!0}else if(a){const u=String.fromCodePoint(Number.parseInt(c.getAttribute("data-hint")||"0",16))||`
`;t.push(u),a=!0}const d=t.join("").replace(/\u00a0/g," ");e.clipboardData.setData("text/plain",d),e.preventDefault()});const g=e=&gt;e.nodeType===Node.TEXT_NODE?e.parentElement:e,m=e=&gt;{const s=g(e);return s?.classList?.contains("tsel")?s:void 0},C=(e,s)=&gt;{const t=document.createElement("div"),a=s.getBoundingClientRect();t.style.position="absolute",t.style.float="left",t.style.left=(a.left+window.scrollX).toString(),t.style.top=(a.top+window.scrollY).toString(),t.style.width=a.width.toString(),t.style.height=a.height.toString(),t.style.backgroundColor="#7db9dea0",e.appendChild(t)},x=e=&gt;{e&&(e.innerHTML="")};if(document.addEventListener("selectionchange",()=&gt;{const e=window.getSelection();let s=document.getElementById("tsel-sel-box");if(x(s),!e?.rangeCount)return;const t=e?.getRangeAt(0);if(!t)return;s||(s=document.createElement("div"),s.id="tsel-sel-box",s.style.zIndex="100",s.style.position="absolute",s.style.pointerEvents="none",s.style.left="0",s.style.top="0",s.style.float="left",document.body.appendChild(s));const a=m(t.startContainer),d=m(t.endContainer),c=h(f=&gt;f.classList?.contains("tsel"));console.log("selectionchange",t,c,a,t.startOffset,d,t.endOffset);const u=new Range;for(let f of c)if(f.classList.contains("tsel")){const v=f===a?t.startOffset:0,b=f===d?t.endOffset:-1,L=findAncestor(f,"typst-text");if(!L)continue;const y=Array.from(L.children).filter(w=&gt;w.tagName==="use");if(!y.length)continue;let S=y[0],N;const T=()=&gt;{u.setStartBefore(S),N===void 0?u.setEndAfter(y[y.length-1]):u.setEndBefore(N),C(s,u)};if(v===0&&b===-1){T();continue}const B=y.map(w=&gt;{const R=w.getAttribute("href"),E=document.getElementById(R.slice(1));return 1+Number.parseInt(E?.getAttribute("data-liga-len")||"0")}),A=w=&gt;{let R=0;for(let E=0;E&lt;B.length;E++){if(R+B[E]&gt;w)return y[E];R+=B[E]}};v!==0&&(S=A(v)||S),b!==-1&&(N=A(b)),T()}}),o.addEventListener("click",e=&gt;{let s=e.target;for(;s;){const t=s.getAttribute("data-span");if(t){console.log("source-span of this svg element",t);const a=document.body||document.firstElementChild,d=a.getBoundingClientRect(),c=window.innerWidth||0,u=e.clientX-d.left+.015*c,f=e.clientY-d.top+.015*c;triggerRipple(a,u,f,"typst-debug-react-ripple","typst-debug-react-ripple-effect .4s linear");return}s=s.parentElement}}),window.location.hash){console.log("hash",window.location.hash);const s=window.location.hash.split("-");if(s.length===2&&s[0]==="#loc"){const t=s[1].split("x");if(t.length===3){const a=Number.parseInt(t[0]),d=Number.parseFloat(t[1]),c=Number.parseFloat(t[2]);window.handleTypstLocation(o,a,d,c)}}}},window.layoutText=function(o){},window.handleTypstLocation=function(o,i,n,l){const r=findAncestor(o,"typst-doc").children;let h=0;for(let g=0;g&lt;r.length;g++)if(r[g].tagName==="g"&&h++,h==i){const m=r[g],C=Number.parseFloat(m.getAttribute("data-page-width")),x=Number.parseFloat(m.getAttribute("data-page-height")),e=m.getBoundingClientRect(),s=Math.max(0,n/C-.05)*e.width,t=Math.max(0,l/x-.05)*e.height,a=n/C*e.width-s,d=l/x*e.height-t,c=document.body||document.firstElementChild,u=c.getBoundingClientRect(),f=e.left-u.left+s,v=e.top-u.top+t,b=f+a,L=v+d;window.scrollTo(f,v),triggerRipple(c,b,L,"typst-jump-ripple","typst-jump-ripple-effect .4s linear");return}};function triggerRipple(o,i,n,l,p){const r=document.createElement("div");r.className=l,r.style.left=i.toString()+"px",r.style.top=n.toString()+"px",o.appendChild(r),r.style.animation=p,r.onanimationend=()=&gt;{o.removeChild(r)}}var scriptTag=document.currentScript;if(scriptTag){console.log("new svg util updated 22  ");const o=findAncestor(scriptTag,"typst-doc");o&&window.typstProcessSvg(o)}
